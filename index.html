
    <!--
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/speech-commands"></script>
    -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.1.2"> </script> 
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/speech-commands@0.3.6"> </script> 


<script>


///////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////// Start original script.js /////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////



/* globals speechCommands */
let recognizer;
//let messageArea;
let recognizerOptions;    // needed this global

//const MESSAGES = {
// 'up': 'ðŸ‘',
//  'down': 'ðŸ™ƒ',
//  'left': 'ðŸ‘ˆ',
//  'right': 'âž¡ï¸',
//}

async function startListening(options, onResult) {
  const {vocabulary, probabilityThreshold} = options;
  
 // document.getElementById('start').disabled = true;
  
  
  recognizer = speechCommands.create('BROWSER_FFT', vocabulary);
  await recognizer.ensureModelLoaded();
//  document.getElementById('container').classList.remove('before-load');
  const words = recognizer.wordLabels();  
    
  recognizer.params().sampleRateHz = 48000
    
  console.log('recognizer.params().sampleRateHz');
  console.log(recognizer.params().sampleRateHz);
  //console.log(recognizer.params().fftSize);
  
  recognizer.listen(result => {    
    const maxScore = Math.max(...result.scores);    
    const maxScoreIndex = result.scores.indexOf(maxScore);    
    const detectedWord = words[maxScoreIndex];    
    
    // Don't trigger on background noise or unknown.
    if (maxScore > probabilityThreshold && maxScoreIndex < 4) {
      onResult({
        detectedWord,
        detectedWordScore: maxScore,
        scores: Array.from(result.scores),
      });
    }
  });
  
 // document.getElementById('stop').disabled = false;
}

async function stopListening() {
  if (recognizer!= null) {
    recognizer.stopListening()
  //  document.getElementById('stop').disabled = true;
   // document.getElementById('start').disabled = false;
   // messageArea.class = '';
  }
}

function onDetection(detectionResult) {
  console.log('ondetection', detectionResult);
  const { detectedWord } = detectionResult;
 // messageArea.innerHTML = MESSAGES[detectedWord];
  //messageArea.className = detectedWord;
    console.log(detectedWord)
    document.getElementById('myDiv01').innerHTML = detectedWord.detectedWord
}

function setupListeners() {
  //const recognizerOptions = {
  recognizerOptions = {
    vocabulary: 'directional4w',
    probabilityThreshold: 0.85,
  };
  
    
 // try '18w' and find all the words   
    
 // document.getElementById('start').addEventListener('click', () => {
  //  startListening(recognizerOptions, onDetection);
 // });
  
 // document.getElementById('stop').addEventListener('click', stopListening);
    
 // messageArea = document.getElementById('last-detected');
}

//document.addEventListener("DOMContentLoaded", function() {
 // 
    
    
//});


///////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////// End original script.js /////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////
</script>



<h2 align=center>tensorflow-models/speech-commands easiest example </h2>
I am able to understand 18 speech commands: 0, 1, 2, 3, 4, 5, 6,7 8, 9,<br>  
"up", "down", "left", "right", <br>
"go", "stop", "yes", "no", <br>
"unknown word" , "background noise".
<br><br>
<div id="myDiv01">...</div><br><br>



<input type=button value=Setup Model" onclick="{
   setupListeners()
       console.log('Speech Commands Setup')
      // console.log(recognizerOptions);
      // console.log(recognizerOptions.params().sampleRateHz);
      // console.log(recognizerOptions.params().fftSize);
       // want 48000
}">
    

<input type=button value="Start" onclick="{
   console.log('Started listening')    
   startListening(recognizerOptions, onDetection);
}">
        
<input type=button value="Stop" onclick="{
   stopListening()
   console.log('Stop Listening')

}">  <br>      
        
        
Original example by @tafsiri at <a href="https://glitch.com/~tfjs-speech-commands">https://glitch.com/~tfjs-speech-commands</a><br>
